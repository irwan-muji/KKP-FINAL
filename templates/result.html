<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Batik AI - Result</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/style.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand mx-auto" href="index.html">
      <img src="../static/logo.png" alt="Logo" class="logo-img">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="index.html">Beranda</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="about.html">Tentang Aplikasi</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="container mt-5 card shadow card-body">
    <div class="row">
      <div class="col-md-6 offset-md-3">
        <h1>Result</h1>
        {% if error %}
        <div class="alert alert-danger" role="alert">
          Deteksi gagal. Silakan upload gambar kembali.
        </div>
        {% else %}
        <h2>{{ result.name }}</h2>
        <img id="resultImage" src="{{ url_for('static', filename='uploads/' + filename) }}" alt="Uploaded Image">
        <p>{{ result.description }}</p>
        {% endif %}
      </div>
    </div>
  </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>


MAIN.JS
$(document).ready(function () {
  // Init
  $(".image-section").hide();
  $(".loader").hide();
  $("#result").hide();

  // Upload Preview
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function (e) {
        $("#uploaded-image").attr("src", e.target.result);
      };
      reader.readAsDataURL(input.files[0]);
    }
  }

  $("#image").change(function () {
    $(".image-section").show();
    $("#submit-btn").show();
    $("#result").text("");
    $("#result").hide();
    readURL(this);
  });

  // Predict
  $("#upload-form").submit(function (event) {
    event.preventDefault();
    var form_data = new FormData($(this)[0]);

    // tampilan loading animation
    $("#submit-btn").hide();
    $(".loader").show();

    // Membuat prediction by calling API /predict
    $.ajax({
      type: "POST",
      url: "/result",
      data: form_data,
      contentType: false,
      cache: false,
      processData: false,
      async: true,
      success: function (data) {
        // Handle success response
        if (data.success) {
          // Redirect ke halaman result
          window.location.href = "/result";
        }
      },
      error: function (xhr, status, error) {
        // Tampilan error
        alert("Deteksi Gagal, silahkan upload gambar yang baik");
        $("#submit-btn").show();
        $(".loader").hide();
      },
    });
  });
});